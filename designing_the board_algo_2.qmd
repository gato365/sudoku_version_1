---
title: "Checking_Fit"
format: html
editor: visual
---


```{r}
library(tidyverse)
```

```{r}
map_board_df = readxl::read_xlsx('empty_board.xlsx',sheet = 'mapping') %>% 
  mutate(values = sample(4,4)) %>%  ## Determine th values for positions 
  separate(col = top_right,into = c('square_tr','pos_tr','row_tr','col_tr'),remove = FALSE) %>% 
  separate(col = top_left,into = c('square_tl','pos_tl','row_tl','col_tl'),remove = FALSE) %>% 
  separate(col = bottom_right,into = c('square_br','pos_br','row_br','col_br'),remove = FALSE) %>% 
  pivot_longer(top_right:col_br)
```




```{r}
checkSpec = function(spec,df){
  result = df %>% 
    filter(value == spec) %>% 
    pull(values) %>% 
    setequal(1:4)
  return(result)
}

determine_rc = function(specType,df) {
  
  return(checkSpec(paste0(specType,1),df) +
           checkSpec(paste0(specType,2),df)  == 2)
}


conductAllDetemineChecks = function(df){
  fiveChecks = determine_rc('C',df) +
    determine_rc('R',df) +
    checkSpec('TR',df) +
    checkSpec('TL',df) +
    checkSpec('BR',df) 
  
  return(fiveChecks == 5)
}

```


```{r}
conductAllDetemineChecks(map_board_df)
```

